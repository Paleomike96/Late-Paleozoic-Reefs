install.packages("readr")
library(readr)
DatosReef1= read.csv("D:\DOCUMENTOS\UNAM\CURSOS\PROGRAMACION\R\Late-Paleozoic-Reefs\pbdb_data_sponges1")
DatosReef1 <- read.csv("D:/DOCUMENTOS/UNAM/CURSOS/PROGRAMACION/R/Late-Paleozoic-Reefs/pbdb_data_sponges1.csv")
View(DatosReef1)
install.packages("dplyr")
library(dplyr)
Nueva_Tabla= DatosReef1 %>%
select("occurrence_no", "identified_name")
select(ocurrence_no, identified_name)
library(readr)
DatosReef1 <- read_csv("pbdb_data_sponges1.csv", skip = 14)
library(dplyr)
ReefClean <- DatosReef1 %>%
select(occurrence_no,
max_ma,
min_ma,
accepted_name)
ReefClean <- DatosReef1 %>%
mutate(edad_promedio = (max_ma + min_ma) / 2) %>%
select(occurrence_no, edad_promedio, accepted_name)
View(ReefClean)
# -----------------------------
# 1. Cargar y limpiar metadatos
# -----------------------------
DatosReef1 <- read_csv("pbdb_data_sponges1.csv", skip = 14) %>%
# 2. Nombres de columnas limpios
clean_names() %>%
# 3. Seleccionar solo lo relevante (puedes agregar más si deseas)
select(
occurrence_no,       # número de ejemplar
accepted_name,       # nombre taxonómico corregido
identified_name,     # por si quieres comparar
max_ma, min_ma,      # edades
early_interval, late_interval,
reference_no,        # bibliografía PBDB
everything()         # deje el resto al final por si lo necesitas
) %>%
# 4. Renombrar a nombres más claros para trabajarlos
rename(
especie = accepted_name,
edad_inicial = max_ma,
edad_final = min_ma
) %>%
# 5. Crear una edad promedio útil para análisis
mutate(
edad_promedio = (edad_inicial + edad_final) / 2
) %>%
# 6. Ordenar por edad (de más antiguo a más reciente)
arrange(desc(edad_promedio)) %>%
# 7. Eliminar duplicados (a veces PBDB repite registros)
distinct(occurrence_no, .keep_all = TRUE)
# Paquetes necesarios
library(readr)
library(dplyr)
library(janitor)
install.packages("janitor")
library(janitor)
# -----------------------------
# 1. Cargar y limpiar metadatos
# -----------------------------
DatosReef1 <- read_csv("pbdb_data_sponges1.csv", skip = 14) %>%
# 2. Nombres de columnas limpios
clean_names() %>%
# 3. Seleccionar solo lo relevante (puedes agregar más si deseas)
select(
occurrence_no,       # número de ejemplar
accepted_name,       # nombre taxonómico corregido
identified_name,     # por si quieres comparar
max_ma, min_ma,      # edades
early_interval, late_interval,
reference_no,        # bibliografía PBDB
everything()         # deje el resto al final por si lo necesitas
) %>%
# 4. Renombrar a nombres más claros para trabajarlos
rename(
especie = accepted_name,
edad_inicial = max_ma,
edad_final = min_ma
) %>%
# 5. Crear una edad promedio útil para análisis
mutate(
edad_promedio = (edad_inicial + edad_final) / 2
) %>%
# 6. Ordenar por edad (de más antiguo a más reciente)
arrange(desc(edad_promedio)) %>%
# 7. Eliminar duplicados (a veces PBDB repite registros)
distinct(occurrence_no, .keep_all = TRUE)
# -----------------------------
# 1. Cargar y limpiar metadatos
# -----------------------------
DatosReef1 <- read_csv("pbdb_data_sponges1.csv", skip = 14) %>%
# -----------------------------
# 1. Cargar y limpiar metadatos
# -----------------------------
DatosReef1 <- read_csv("pbdb_data_sponges1.csv", skip = 14) %>%
# 2. Nombres de columnas limpios
clean_names() %>%
# -----------------------------
# 1. Cargar y limpiar metadatos
# -----------------------------
DatosReef1 <- read_csv("pbdb_data_sponges1.csv", skip = 14) %>%
# 2. Nombres de columnas limpios
clean_names() %>%
# 3. Seleccionar solo lo relevante (puedes agregar más si deseas)
select(
occurrence_no,       # número de ejemplar
accepted_name,       # nombre taxonómico corregido
identified_name,     # por si quieres comparar
max_ma, min_ma,      # edades
early_interval, late_interval,
reference_no,        # bibliografía PBDB
everything()         # deje el resto al final por si lo necesitas
) %>%
# -----------------------------
# 1. Cargar y limpiar metadatos
# -----------------------------
DatosReef1 <- read_csv("pbdb_data_sponges1.csv", skip = 14) %>%
# 2. Nombres de columnas limpios
clean_names() %>%
# 3. Seleccionar solo lo relevante (puedes agregar más si deseas)
select(
occurrence_no,       # número de ejemplar
accepted_name,       # nombre taxonómico corregido
identified_name,     # por si quieres comparar
max_ma, min_ma,      # edades
early_interval, late_interval,
reference_no,        # bibliografía PBDB
everything()         # deje el resto al final por si lo necesitas
) %>%
# 4. Renombrar a nombres más claros para trabajarlos
rename(
especie = accepted_name,
edad_inicial = max_ma,
edad_final = min_ma
) %>%
# -----------------------------
# 1. Cargar y limpiar metadatos
# -----------------------------
DatosReef1 <- read_csv("pbdb_data_sponges1.csv", skip = 14) %>%
# 2. Nombres de columnas limpios
clean_names() %>%
# 3. Seleccionar solo lo relevante (puedes agregar más si deseas)
select(
occurrence_no,       # número de ejemplar
accepted_name,       # nombre taxonómico corregido
identified_name,     # por si quieres comparar
max_ma, min_ma,      # edades
early_interval, late_interval,
reference_no,        # bibliografía PBDB
everything()         # deje el resto al final por si lo necesitas
) %>%
# 4. Renombrar a nombres más claros para trabajarlos
rename(
especie = accepted_name,
edad_inicial = max_ma,
edad_final = min_ma
) %>%
# 5. Crear una edad promedio útil para análisis
mutate(
edad_promedio = (edad_inicial + edad_final) / 2
) %>%
# -----------------------------
# 1. Cargar y limpiar metadatos
# -----------------------------
DatosReef1 <- read_csv("pbdb_data_sponges1.csv", skip = 14) %>%
# 2. Nombres de columnas limpios
clean_names() %>%
# 3. Seleccionar solo lo relevante (puedes agregar más si deseas)
select(
occurrence_no,       # número de ejemplar
accepted_name,       # nombre taxonómico corregido
identified_name,     # por si quieres comparar
max_ma, min_ma,      # edades
early_interval, late_interval,
reference_no,        # bibliografía PBDB
everything()         # deje el resto al final por si lo necesitas
) %>%
# 4. Renombrar a nombres más claros para trabajarlos
rename(
especie = accepted_name,
edad_inicial = max_ma,
edad_final = min_ma
) %>%
# 5. Crear una edad promedio útil para análisis
mutate(
edad_promedio = (edad_inicial + edad_final) / 2
) %>%
# 6. Ordenar por edad (de más antiguo a más reciente)
arrange(desc(edad_promedio)) %>%
# -----------------------------
# 1. Cargar y limpiar metadatos
# -----------------------------
DatosReef1 <- read_csv("pbdb_data_sponges1.csv", skip = 14) %>%
# 2. Nombres de columnas limpios
clean_names() %>%
# 3. Seleccionar solo lo relevante (puedes agregar más si deseas)
select(
occurrence_no,       # número de ejemplar
accepted_name,       # nombre taxonómico corregido
identified_name,     # por si quieres comparar
max_ma, min_ma,      # edades
early_interval, late_interval,
reference_no,        # bibliografía PBDB
everything()         # deje el resto al final por si lo necesitas
) %>%
# 4. Renombrar a nombres más claros para trabajarlos
rename(
especie = accepted_name,
edad_inicial = max_ma,
edad_final = min_ma
) %>%
# 5. Crear una edad promedio útil para análisis
mutate(
edad_promedio = (edad_inicial + edad_final) / 2
) %>%
# 6. Ordenar por edad (de más antiguo a más reciente)
arrange(desc(edad_promedio)) %>%
# 7. Eliminar duplicados (a veces PBDB repite registros)
distinct(occurrence_no, .keep_all = TRUE)
readLines("pbdb_data_sponges1.csv", n = 30)
glimpse(DatosReef1)
glimpse(DatosReef1)
DatosReef1 <- read_csv(
"pbdb_data_sponges1.csv",
skip = 18
)
glimpse(DatosReef1)
library(dplyr)
library(janitor)
ReefClean <- DatosReef1 %>%
clean_names() %>%
select(
occurrence_no,
accepted_name,
early_interval,
late_interval,
max_ma,
min_ma
) %>%
mutate(edad_promedio = (max_ma + min_ma)/2)
library(dplyr)
library(readr)
# 1. Cargar quitando las líneas iniciales de metadata de PBDB
DatosReef1 <- read_csv("pbdb_data_sponges1.csv", skip = 18)
# 2. Pipeline completo de organización de la base
TablaFinal <- DatosReef1 %>%
# Seleccionar solo las columnas útiles
select(
occurrence_no,
accepted_name,
accepted_rank,
early_interval,
late_interval,
max_ma,
min_ma,
reference_no
) %>%
# 3. Limpiar nombre de taxón
mutate(
accepted_name = trimws(accepted_name),
accepted_name = tolower(accepted_name)
) %>%
# 4. Crear edad promedio para análisis
mutate(
edad_promedio = (max_ma + min_ma) / 2
) %>%
# 5. Ordenar por edad (más antiguo → más joven)
arrange(desc(edad_promedio))
View(DatosReef1)
View(TablaFinal)
View(ReefClean)
View(TablaFinal)
View(DatosReef1)
View(ReefClean)
View(ReefClean)
View(TablaFinal)
View(DatosReef1)
View(TablaFinal)
ggplot(TablaFinal, aes(x = early_interval, y = edad_promedio)) +
geom_boxplot() +
theme_minimal() +
labs(
x = "Early Interval",
y = "Edad promedio (Ma)",
title = "Distribución temporal por intervalo"
) +
coord_flip()
install.packages("ggplot2")
ggplot(TablaFinal, aes(x = early_interval, y = edad_promedio)) +
geom_boxplot() +
theme_minimal() +
labs(
x = "Early Interval",
y = "Edad promedio (Ma)",
title = "Distribución temporal por intervalo"
) +
coord_flip()
library(ggplot2)
ggplot(TablaFinal, aes(x = early_interval, y = edad_promedio)) +
geom_boxplot() +
theme_minimal() +
labs(
x = "Early Interval",
y = "Edad promedio (Ma)",
title = "Distribución temporal por intervalo"
) +
coord_flip()
ggplot(TablaFinal, aes(x = edad_promedio, y = accepted_name)) +
geom_point(alpha = 0.4) +
labs(
x = "Edad promedio (Ma)",
y = "Taxón",
title = "Distribución temporal de taxones"
) +
theme_minimal()
PCA_data <- TablaFinal %>%
select(max_ma, min_ma, edad_promedio) %>%
na.omit()
summary(PCA_res)
biplot(PCA_res, cex = 0.7)
PCA_data <- TablaFinal %>%
select(max_ma, min_ma, edad_promedio) %>%
na.omit()
PCA_res <- prcomp(PCA_data, scale. = TRUE)
summary(PCA_res)
biplot(PCA_res, cex = 0.7)
View(PCA_data)
View(PCA_res)
View(DatosReef1)
Abundancia <- TablaFinal %>%
mutate(
nivel = ifelse(accepted_rank == "genus", "genus",
ifelse(accepted_rank == "species", "species", NA))
) %>%
filter(!is.na(nivel)) %>%
group_by(early_interval, nivel) %>%
summarise(n = n(), .groups = "drop")
Abundancia_wide <- Abundancia %>%
tidyr::pivot_wider(
names_from = nivel,
values_from = n,
values_fill = 0
)
ggplot(Abundancia_wide, aes(x = genus, y = species, label = early_interval)) +
geom_point(size = 4) +
geom_text(vjust = -0.6, size = 4) +
labs(
x = "Abundancia de géneros",
y = "Abundancia de especies",
title = "Diversidad por early_interval: Géneros vs Especies"
) +
theme_minimal()
